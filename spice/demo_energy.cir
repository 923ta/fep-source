DEMO CIRCUIT
*関数g(φ)がφ^2 抵抗の単位は100k(作図時は1M) コンデンサの単位は100n(作図時は1μ)

.include 'LMC6482A.LIB'

.global vcc vee
vcc vcc 0 5
vee vee 0 -5

.ic v(1)=0v v(4)=3v v(7)=0v v(2)=0v v(5)=0v
.ic v(112)=0v v(122)=0v v(132)=0v v(142)=0v v(152)=0v

* x1 10 1 intAmp
* x2 3 4 intAmp
* x3 6 7 intAmp
* x4 1 2 invAmp
* x5 4 5 invAmp

v1 8 0 1
v2 0 9 2

vd1 101 10 0 ; r1の消費電力プロット用ダミー電圧源
vd2 102 6 0 ; r2の消費電力プロット用ダミー電圧源
vd3 103 3 0
vd4 104 6 0
vd5 105 6 0
vd6 106 10 0
vd7 107 3 0
vd8 108 10 0

r1 1 101 100k ;1/Σu
r2 5 102 100k
r3 7 103 100k
r4 7 104 100k ;1/Σp
* r5 8 105 100k
* r5 8 105 33k ;1/vp
* r5 8 105 70.7k ;1/vp
r5 8 105 50k
r6 9 106 100k
* r7 2 107 r='50000 / v(4)' ;1/g'
* r8 8 108 r='100000 / v(4) / v(4)' ;1/g
r7 2 107 100k
r8 4 108 100k


* εuに関する積分器
x1 0 112 vcc vee 1 LMC6482A/NS
r11 10 111 100k
c11 112 1 100n
vd11 111 112 0

* φに関する積分器
x2 0 122 vcc vee 4 LMC6482A/NS
r21 3 121 100k
c21 122 4 100n
vd21 121 122 0

* εpに関する積分器
x3 0 132 vcc vee 7 LMC6482A/NS
r31 6 131 100k
c31 132 7 100n
vd31 131 132 0

* εuに関する反転増幅器
x4 0 143 vcc vee 2 LMC6482A/NS
r41 1 141 100k
r42 143 142 100k
vd41 141 143 0
vd42 142 2 0

* φに関する反転増幅器
x5 0 153 vcc vee 5 LMC6482A/NS
r51 4 151 100k
r52 153 152 100k
vd51 151 153 0
vd52 152 5 0

.control
tran 100u 500m
plot v(4) v(1) v(7)
* plot v(4) ;φ
* plot v(1) ;εu
plot v(7) ;εp
plot i(vd1)*(v(1)-v(101)) + i(vd3)*(v(7)-v(103)) + i(vd4)*(v(7)-v(104))+ i(vd7)*(v(2)-v(107))
+    + i(vd11)*(v(10)-v(111)) + i(vd21)*(v(3)-v(121)) + i(vd31)*(v(6)-v(131)) + i(vd41)*(v(1)-v(141)) + i(vd42)*(v(143)-v(142))
plot i(vd2)*(v(5)-v(102)) +i(vd5)*(v(8)-v(105)) + i(vd6)*(v(9)-v(106)) + i(vd8)*(v(8)-v(105))
+    + i(vd51)*(v(4)-v(151)) + i(vd52)*(v(151)-v(152))

.endc

.end